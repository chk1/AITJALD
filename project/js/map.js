var wkt = new Wkt.Wkt(); // Wicket library for WKT geometries

var map = L.map('map').setView([51.9609808, 7.62416839], 13);

var defaults = {
    icon: new L.Icon({
        iconUrl: 'red_dot.png',
        iconSize: [16, 16],
        iconAnchor: [8, 8],
        shadowUrl: 'dot_shadow.png',
        shadowSize: [16, 16],
        shadowAnchor: [8, 8]
    }),
    editable: true,
    color: '#AA0000',
    weight: 3,
    opacity: 1.0,
    fillColor: '#AA0000',
    fillOpacity: 0.2
};

L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
}).addTo(map);
var fglevel1 = L.featureGroup().addTo(map);
var fglevel2 = L.featureGroup();//.addTo(map);
var fglevel3 = L.featureGroup();//.addTo(map);

// level 1
wkt.read("POLYGON((7.61745833076313 51.9618257763844,7.61745695784963 51.9618707705771,7.61737868039714 51.9620498978894,7.61744598057284 51.9622307458042,7.61751323359576 51.9624119348868,7.61751186287541 51.9624569284911,7.61771228412111 51.9630444104996,7.6177081664772 51.9631794115699,7.61768696253007 51.9633683947501,7.6177699437465 51.9635402019559,7.61767523409853 51.9642592734031,7.61756801306355 51.9648576621128,7.61748940663817 51.9650374294883,7.61741079911622 51.9652171947914,7.61717496613288 51.9657569008776,7.61701914264427 51.9660712759495,7.61671858589119 51.9663388369886,7.61656832643059 51.9664726059303,7.61612450472869 51.9666481614155,7.61590259223287 51.9667359385624,7.61648415433234 51.9668329890966,7.61743096954021 51.9669342238631,7.61786926669085 51.966939270394,7.61794230853992 51.9669401115387,7.61845221924903 51.9669911490637,7.61969263453011 51.9670505966065,7.62064362385557 51.9670163813427,7.6215229612424 51.9669361743732,7.62218313141211 51.9668534208502,7.62299081521542 51.9667272223708,7.62320998078767 51.9667297461547,7.62357380615377 51.9667791022993,7.62371850103807 51.9668259335978,7.62408232585588 51.9668752896365,7.62466392578723 51.9669723412202,7.62495470711111 51.9670208546033,7.6258987392084 51.9672123875696,7.62749880793114 51.9674566389842,7.62844423048715 51.967603043195,7.62859031802331 51.9676047257973,7.62909887446072 51.9677009113626,7.62917191795466 51.967701752493,7.62953574112761 51.9677511065538,7.62989959281154 51.9678008277517,7.63026341598449 51.9678501827168,7.63040950352065 51.9678518642965,7.6306286690929 51.967854388017,7.63070171149026 51.9678552291446,7.63099527537644 51.9678134443407,7.63151079891121 51.967683517187,7.63188018775704 51.9675522522886,7.63233100177756 51.9671509529196,7.63293760529284 51.9664352357282,7.63309203667787 51.9661660145662,7.6332450770559 51.965941942694,7.63332511341674 51.9657170059001,7.63340790602204 51.9654013976625,7.63364790160892 51.9647266216998,7.63388094051591 51.9642775986137,7.63419954252816 51.9634230329406,7.63430160746149 51.963237679712,7.63430435109533 51.9631476720661,7.63430846873924 51.9630126931976,7.63431258473829 51.9628777139226,7.6342425754709 51.9627868785205,7.63424943674865 51.9625618894055,7.63425218202735 51.9624719013489,7.63418628875902 51.9622460849609,7.6341945213054 51.9619760980762,7.6342010196164 51.9617508937365,7.63413375562772 51.9615700682109,7.63414198762581 51.9613000772544,7.63415022126877 51.9610301079837,7.63405833640128 51.960890996857,7.63394156638011 51.9607125733978,7.63387018419923 51.9606667290095,7.63387155711272 51.9606217336082,7.63365874784485 51.9604392051149,7.63334873366969 51.9602051948455,7.63320543088898 51.9601131982066,7.63306490738084 51.9599308892801,7.63242139420474 51.9594717234099,7.63220921930624 51.9592434119634,7.63185235062002 51.9589682369193,7.63178069922967 51.9589222366785,7.63071002792473 51.9580963539041,7.63056811560273 51.9579591950483,7.6303531597868 51.9578211947949,7.63006933349794 51.9575468513284,7.62999768210759 51.9575008506428,7.62978407891849 51.9573176884158,7.62964216440334 51.9571805275156,7.62942581977356 51.9570876610398,7.62935277573133 51.9570868207238,7.62899312448282 51.9569019738012,7.6279815855052 51.9565285247524,7.62776523923055 51.9564356802404,7.62732837201538 51.9563854723766,7.62689007705789 51.9563804233059,7.62667094712437 51.9563779002908,7.62637877369691 51.9563745352568,7.62579161138241 51.9564581261543,7.62557108934531 51.9565007628852,7.62476200192436 51.9566725399863,7.62454148208041 51.9567151765133,7.62439396789852 51.9567586536598,7.62402597115627 51.9568447681817,7.62343741673818 51.9569735178059,7.62262976802531 51.9570997670619,7.62240921034948 51.957142402169,7.6223347774934 51.9571867212427,7.62110413599667 51.9568111175049,7.62088500661143 51.9568085941762,7.62059279699696 51.9568052284987,7.620370886146 51.956893024584,7.62014758319147 51.9570260033619,7.61999871418959 51.9571146406819,7.61977676550675 51.9572024364992,7.61970846141547 51.9572599640019,7.61948998394484 51.9572572558769,7.6195506810865 51.9574257107383,7.61962588428741 51.9575739658461,7.61961676844884 51.9576523717797,7.61961398698312 51.9577426894824,7.6196080347671 51.9581593318782,7.61945292295649 51.9584726418791,7.61936703690951 51.9586433630093,7.6192991456792 51.9587409294262,7.61929777331399 51.9587859267152,7.61891624591709 51.9590451514275,7.61831517243597 51.9595803348462,7.61810486445858 51.9597173279192,7.61794161002084 51.959847072408,7.61772874702072 51.9601180738724,7.61763131731531 51.960430768121,7.61764500423208 51.9604775803756,7.61764363131858 51.9605225759216,7.61755029458411 51.9611966776421,7.61754480621985 51.9613766566678,7.61746793731958 51.9615107924592,7.61746244676218 51.9616907935353,7.61745833076313 51.9618257763844))");
var msAltstadt = wkt.toObject({color:'#bb6666',weight:2});
msAltstadt.bindPopup('Altstadt<br>Population: 1234');

// level 2
wkt.read("POLYGON((7.61828618718359 51.9596883206335,7.61806270987343 51.959821483702,7.61791231937197 51.9599554325794,7.61768459282874 51.9602240477611,7.61760154362459 51.9605393627059,7.61760011533399 51.9605845132662,7.61759868704339 51.9606296637811,7.61750421480419 51.9613061741246,7.6174985016418 51.9614867726658,7.61742116560003 51.9616214581463,7.61741545243764 51.9618020787288,7.61741115660009 51.9619378936974,7.61740972830949 51.9619830658227,7.61733096397713 51.962162897769,7.61739830527444 51.9623442567234,7.61746564492688 51.9625256139305,7.61746421608799 51.9625707854635,7.61766481004446 51.9631600254381,7.61766052517267 51.9632954687261,7.61765481365514 51.9634760602662,7.61772215495245 51.9636574128941,7.61762624016715 51.9643794158253,7.61753462286428 51.9649655777575,7.61745585688706 51.9651454207102,7.61737709255469 51.9653252413207,7.61752450749644 51.965281850181,7.61898846533396 51.9652064375206,7.61928071387689 51.9652094914331,7.61942681950656 51.9652110180515,7.61950129896713 51.9651666359678,7.62008575712454 51.9651727444737,7.62037654009328 51.9652209432654,7.62052264572295 51.9652224708969,7.62059569853778 51.9652232333613,7.62066732306202 51.9652691430188,7.62081342869169 51.9652706696351,7.62088648150652 51.96527143345,7.62110423468853 51.9653192601943,7.6213978868491 51.965276777789,7.6215439908339 51.9652783044051,7.62161847193933 51.965233922388,7.62169152475417 51.9652346862035,7.62183763038384 51.965236212821,7.62205825275767 51.9651933573812,7.62213130557251 51.9651941211974,7.62242494512244 51.9651520285208,7.62264695850328 51.9650640269976,7.62272286625444 51.9649744986752,7.62279734900474 51.9649300933852,7.62294777514493 51.9647961813313,7.62309673571093 51.9647074152849,7.62317264510696 51.9646178865881,7.62332303396356 51.9644839736014,7.62339777221613 51.9644396630929,7.62333186085428 51.9642131424463,7.62319285720086 51.9639858804662,7.6231255180967 51.9638045281538,7.6232730876557 51.963760908518,7.62334756876113 51.9637165249984,7.62349653097199 51.9636277338411,7.62371854435283 51.9635397293251,7.62394342692549 51.9633610620181,7.62409096084575 51.96331741864,7.62431158321959 51.9632745613656,7.62417115346871 51.9630924423232,7.62403218764717 51.9628651756744,7.62396913122165 51.9625483503803,7.62390179156921 51.9623669922517,7.62390321821494 51.9623218434867,7.62383445191676 51.9621856110915,7.62369976932214 51.9618228915031,7.62363100192739 51.9616866795516,7.62349346439644 51.9614142327846,7.62342756400036 51.9611873306162,7.62342899229095 51.9611421810009,7.62335879605731 51.9610511170714,7.62328999028239 51.9609149031127,7.62314365108198 51.9609136719707,7.62284854924758 51.9610009177549,7.62248185688281 51.961042250443,7.62218964562346 51.9610391962465,7.62197187983083 51.9609917554943,7.62175414967692 51.9609443150298,7.62183149832931 51.9608092376298,7.6218372114917 51.9606286363589,7.62184149471863 51.9604931850127,7.62176987019439 51.9604472704633,7.62177415506619 51.9603118185691,7.62163090601771 51.9602199670909,7.62127421059055 51.9599452430051,7.62105929918595 51.9598074988837,7.62084299732264 51.9597149057752,7.62077137279841 51.9596689681297,7.62062812429822 51.9595771376334,7.62026714509584 51.959437865566,7.62005223369124 51.9593001188719,7.61947638146444 51.9590230764372,7.61926162687025 51.9588851014202,7.61888775686548 51.959152218152,7.61828618718359 51.9596883206335))");
var msAltstadtUeberwasser = wkt.toObject({color:'#bb0000',weight:2});
msAltstadtUeberwasser.bindPopup('Ãœberwasser<br>Population: 1234');

wkt.read("POLYGON((7.62077137279841 51.9596689681297,7.62084299732264 51.9597149057752,7.62105929918595 51.9598074988837,7.62127421059055 51.9599452430051,7.62163090601771 51.9602199670909,7.62177415506619 51.9603118185691,7.62176987019439 51.9604472704633,7.62184149471863 51.9604931850127,7.6218372114917 51.9606286363589,7.62183149832931 51.9608092376298,7.62175414967692 51.9609443150298,7.62197187983083 51.9609917554943,7.62218964562346 51.9610391962465,7.62248185688281 51.961042250443,7.62284854924758 51.9610009177549,7.62314365108198 51.9609136719707,7.62328999028239 51.9609149031127,7.62343756038968 51.9608712806648,7.62365957322222 51.9607832697234,7.62388158824792 51.960695237662,7.62402912216819 51.9606516139869,7.62395892428969 51.9605605490608,7.62388729976545 51.9605146349183,7.6238156757895 51.9604687214044,7.62360080221679 51.9603309788915,7.62374833613706 51.9602873548619,7.62389444176673 51.9602888816479,7.62411502630868 51.9602460214778,7.62477253782921 51.9602528942169,7.62513780135509 51.9602567116915,7.62528251488118 51.9603033889842,7.62542862051085 51.9603049167832,7.62564635066476 51.9603523582622,7.62593570479462 51.9604457125998,7.62593856137581 51.9603554114919,7.62594783950767 51.9603043268811,7.62594427289334 51.9601748083926,7.62594570118394 51.9601296344451,7.62595141270146 51.9599490304363,7.62595426983095 51.95985872799,7.62588978675969 51.9595870340249,7.62589264169603 51.9594967311873,7.62582530204358 51.9593153607123,7.62575796074627 51.9591339895035,7.62569206035019 51.9589070757932,7.62585101895037 51.9585022081171,7.62600426438817 51.9582779715668,7.62601234560702 51.9581890179306,7.62616179305289 51.9579182514551,7.62631507632256 51.9576940129976,7.62631650461316 51.9576488598639,7.62639812552672 51.9573786780393,7.62640383704424 51.9571980629477,7.62640526533484 51.9571529093145,7.62640955020663 51.9570174471284,7.62641240678783 51.9569271168145,7.62635387099801 51.956474352215,7.62576658257723 51.9565589194209,7.62554595855854 51.9566018060924,7.62473662989081 51.9567740234093,7.62451604534886 51.9568168868989,7.62436851142859 51.9568605143056,7.62400039241809 51.9569470050351,7.62341164938889 51.9570763578255,7.62260374956004 51.9572034440648,7.62238253010043 51.9572463003862,7.62230805118815 51.9572906903123,7.62107754402201 51.9569164548649,7.6208583855775 51.9569141640068,7.62056613867944 51.9569111091912,7.62034412365374 51.9569991267211,7.6201206819823 51.9571323210916,7.61997171977144 51.9572211021393,7.6197497063906 51.9573091190606,7.61967522528517 51.9573535089245,7.61945629712168 51.9573509910324,7.61952362580836 51.9575327593682,7.61959239539627 51.9576689836039,7.61958953881508 51.9577592901231,7.61958668223388 51.9578495967983,7.61957382871508 51.9582559968854,7.61941772669609 51.958570561744,7.61933896236373 51.9587504073803,7.61926305516085 51.9588399491482,7.61926162687025 51.9588851014202,7.61947638146444 51.9590230764372,7.62005223369124 51.9593001188719,7.62026714509584 51.959437865566,7.62062812429822 51.9595771376334,7.62077137279841 51.9596689681297))");
var msAltstadtAegidii = wkt.toObject({color:'#bb0000',weight:2});
msAltstadtAegidii.bindPopup('Aegidii<br>Population: 1234');

// level 3
wkt.read("POLYGON((7.61995423870076 51.9611346938438,7.61995561106597 51.9610896989123,7.62010660742582 51.960911392466,7.62025760159252 51.9607331089604,7.62054998885235 51.9606915077295,7.62091379173864 51.9606957512034,7.62127618826586 51.9607449889861,7.62171000096782 51.9608400719863,7.62185550841513 51.9608417680189,7.62185962441418 51.9607067822067,7.62186511332672 51.9605268004915,7.62187060388413 51.9603467950792,7.62180196698195 51.9602109597484,7.62173332843491 51.9600751226545,7.62130364269776 51.9598446620963,7.62108950054142 51.9597071271413,7.62087535674022 51.9595695694652,7.62080260219413 51.9595687200734,7.62080397455934 51.9595237235701,7.62065984002552 51.9594770309374,7.62037427840471 51.959293648724,7.62008737950913 51.9591552640303,7.6195135482724 51.9588784697105,7.61929777331399 51.9587859267152,7.61899852642128 51.9590525382487,7.61832861317137 51.9595398654065,7.61810486445858 51.9597173279192,7.61802799336515 51.9598514686758,7.61772874702072 51.9601180738724,7.61764774951078 51.960387565836,7.61764500423208 51.9604775803756,7.61764363131858 51.9605225759216,7.61755029458411 51.9611966776421,7.61754480621985 51.9613766566678,7.61746793731958 51.9615107924592,7.61746244676218 51.9616907935353,7.61745833076313 51.9618257763844,7.61775093898308 51.9617841785325,7.61818886932895 51.9617442756269,7.61862676184294 51.9617043726857,7.61877367784248 51.9616610756789,7.61906606510231 51.9616194753092,7.61914019036874 51.9615753069065,7.61943394889721 51.9614887119261,7.61965499180804 51.9614012691106,7.61987736815562 51.9612688303593,7.61987874052083 51.9612238355624,7.61995423870076 51.9611346938438))");
var msAltstadtUeberwasserBispinghof = wkt.toObject({color:'#0000bb',weight:2});
msAltstadtUeberwasserBispinghof.bindPopup('Bispinghof<br>Population: 1234');

wkt.read("POLYGON((7.62312407171259 51.9598210198164,7.62291126244472 51.9596384884007,7.62255424681728 51.9594091692739,7.62234143754941 51.959226636857,7.62220004829429 51.9590899490689,7.62212729374821 51.9590891000059,7.6219845315796 51.9589974085374,7.62184176941099 51.9589057172192,7.62162899852328 51.9587231597772,7.62141756162062 51.9584956260182,7.62113478091724 51.9582222222542,7.62113616260334 51.9581768581426,7.62099477334823 51.9580401668159,7.62078200191224 51.9578576058492,7.62063920191175 51.9577659121998,7.62042643102404 51.9575833720785,7.62035504884316 51.9575375255037,7.62014227740717 51.9573549624902,7.61992676069247 51.9572624187152,7.61970846141547 51.9572599640019,7.61948998394484 51.9572572558769,7.61955862029873 51.9573931001577,7.61962588428741 51.9575739658461,7.61962451356707 51.9576189643064,7.61969452283445 51.9577098101808,7.6196080347671 51.9581593318782,7.61945292295649 51.9584726418791,7.61937605241135 51.9586067863601,7.6192991456792 51.9587409294262,7.61929777331399 51.9587859267152,7.6195135482724 51.9588784697105,7.62008737950913 51.9591552640303,7.62037427840471 51.959293648724,7.62065984002552 51.9594770309374,7.62080397455934 51.9595237235701,7.62080260219413 51.9595687200734,7.62087535674022 51.9595695694652,7.62108950054142 51.9597071271413,7.62130364269776 51.9598446620963,7.62173332843491 51.9600751226545,7.62180196698195 51.9602109597484,7.62187060388413 51.9603467950792,7.62186511332672 51.9605268004915,7.62185962441418 51.9607067822067,7.62185550841513 51.9608417680189,7.62199964294895 51.9608884605815,7.62228928493008 51.9609368498002,7.6225089554757 51.960894401081,7.62287272272326 51.9608986435222,7.62316648125172 51.9608120472347,7.62331339670297 51.9607687503796,7.623460391656 51.9607252926633,7.62368139728324 51.960637847345,7.62390102999698 51.9605953969912,7.62404794544823 51.9605520999269,7.62397793618085 51.9604612598121,7.62390651836124 51.9604154148288,7.62383650909385 51.9603245754506,7.62369374692524 51.9602328635346,7.6234809776824 51.9600502662235,7.62319545170032 51.9598668873686,7.62312407171259 51.9598210198164))");
var msAltstadtAegidiiAegidiimarkt = wkt.toObject({color:'#0000bb',weight:2});
msAltstadtAegidiiAegidiimarkt.bindPopup('Aegidiimarkt<br>Population: 1234');

fglevel1.addLayer(msAltstadt);
fglevel2.addLayer(msAltstadtUeberwasser);
fglevel2.addLayer(msAltstadtAegidii);
fglevel3.addLayer(msAltstadtUeberwasserBispinghof);
fglevel3.addLayer(msAltstadtAegidiiAegidiimarkt);

map.on('zoomend', function () {
	console.log(map.getZoom());
	// show level 1 layer up to zoom 14
	if (map.getZoom() > 14 && map.hasLayer(fglevel1)){
		map.removeLayer(fglevel1);
	}
	if (map.getZoom() <= 14 && !map.hasLayer(fglevel1)) {
		map.addLayer(fglevel1);
	}

	// show level 2 layer from zoom 14 to 16
	if ((map.getZoom() <= 14 || map.getZoom() >= 17) && map.hasLayer(fglevel2)) {
		map.removeLayer(fglevel2);
	}
	if ((map.getZoom() > 14 && map.getZoom() < 17) && !map.hasLayer(fglevel2)){
		map.addLayer(fglevel2);
	}

	// show level 3 layer from zoom 16
	if (map.getZoom() <= 16 && map.hasLayer(fglevel3)) {
		map.removeLayer(fglevel3);
	}
	if (map.getZoom() > 16 && !map.hasLayer(fglevel3)){
		map.addLayer(fglevel3);
	}
});